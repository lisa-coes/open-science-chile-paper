---
author: LISA COES
editor: 
  markdown: 
    wrap: 72
    echo: false
    include: true
---

```{r setup-chunk, include=FALSE}
knitr::opts_chunk$set(dev = 'png', dpi = 600, fig.width = 6, fig.height = 4,
                      message = FALSE, warning = FALSE, echo = FALSE, cache = TRUE)
#knitr::opts_knit$set(root.dir = "../3_output/img-cais-alas")
options(scipen=999)
options(knitr.kable.NA = '')
getwd()
```

```{r load-library, include=FALSE}
library(formr)
library(tidyverse)
library(writexl)
library(sjlabelled)
library(summarytools)
library(sjmisc)
library(summarytools)
library(ggrepel)
library(gridExtra)
library(kableExtra)
```

```{r load-dataset, include=FALSE}
remove(list = ls())
load("../input/data/cais.RData") #cargar datos local
```

```{r na-count, include=FALSE}
#names(lisa_cc)

lisa_v2_all <- cais %>% 
  rowwise() %>%
  mutate(n_NAs = sum(is.na(across(everything())))) #generamos una nueva variable que cuenta número de NA

lisa_v2_75 <- lisa_v2_all %>% 
  filter(n_NAs < 37) #N=40 -> 42 -> 70 -> 72

# lisa_v2_50 <- lisa_v2_all %>% 
#   filter(n_NAs < 72) #N=46 -> 48 -> 78 -> 80
# 
# lisa_v2_15 <- lisa_v2_all %>% 
#   filter(n_NAs < 108) #N=65 -> 69 -> 107 -> 112
```

```{r select-dataset, include=FALSE}

cais_v2 <- lisa_v2_75 %>% 
  haven::zap_labels() %>% # eliminar las etiquetas de variables (haven_labelled) de una base de datos
  filter(mod01_6 > 1950) %>%  # filtrar datos de encuestas dudosas y de prueba
  mutate(edad0 = factor(car::recode(mod08_1, "28:34 = 1; 35:49 = 2; 50:80 = 3"), 
                        levels = c(1,2,3),
                        labels = c("28-34", "35-49", "50+")),
         grado0 = factor(car::recode(mod01_5, "1=1; 2:3=2"),
                         levels= c(1,2),
                         labels= c("Master", "PhD")),
         etapa0 = factor(car::recode(mod01_1, "0:5 = 1; 6:15 = 2; 16:60 = 3"),
                         levels= c(1,2,3),
                         labels= c("Early (0 to 5 years)", "Intermediate (6 to 15 years)", "Avanced (>15 years)")),
         enfoq0 = case_when(mod01_10 == 1 ~ 1, # cuali
                            mod01_10 == 2 ~ 2, # mixto  
                            mod01_10 %in% c(3,4) ~ 3, #cuanti
                            mod01_10 == 4 ~ NA_real_),
         mod08_2= factor(mod08_2,
                         levels= c(1,2),
                         labels=c("Women", "Men")),
         enfoq0= factor(enfoq0,
                        levels= c(1,2,3),
                        labels= c("Qualitative", "Mixed-Methods", "Quantitative")),
         sexo = as_label(mod08_2),
         edad = as_label(edad0),
         grado = as_label(grado0),
         etapa = as_label(etapa0),
         enfoq = as_label(enfoq0))

  
legend = "Source CAIS (2024), N = 98"

# Contar items
# cais_v2 <- cais_v2 %>% select(4:114)
# mod01 <- cais_v2 %>% select(starts_with("mod01"))
# mod02 <- cais_v2 %>% select(starts_with("mod02"))
# mod03 <- cais_v2 %>% select(starts_with("mod03"))
# mod04 <- cais_v2 %>% select(starts_with("mod04"))
# mod05 <- cais_v2 %>% select(starts_with("mod05"))
# mod06 <- cais_v2 %>% select(starts_with("mod06"))
# mod07 <- cais_v2 %>% select(starts_with("mod07"))
# mod08 <- cais_v2 %>% select(starts_with("mod08"))
```

# Quantitative Study

## Methods

The results of the Open Science in Social Research (CAIS) survey were
used as the basis for the quantitative study. Its questionnaire was
designed by our research team based on the literature review
[@baker_1500_2016; @delikoura_open_2021; @enke_user_2012;
@gross_landscapes_2015; @hail_reproducibility_2020;
@hodonu-wusu_malasyan_2020; @lacey_open_2020; @ljubenkovic_survey_2021;
@lopezcardenas_percepciones_2021; @knudtson_survey_2019;
@pardomartinez_knowledge_2018; @rodriguez_awareness_2014;
@rowley_academics_2017; @sturmer_earlycareer_2017;
@zhu_openaccess_2020], as well as findings from the qualitative study.

The questionnaire consisted of 111 questions divided into the following
modules:

1.  **Academic Career**: 14 items to describe the academic career and
    participation in research projects of the respondents.
2.  **General Aspects of Open Science**: 20 items about the level of
    knowledge of the participants about open science and the tools it
    provides.
3.  **Research Practices, Openness and Ethics in Social Sciences:** 14
    items assessing the frequency with which the researchers perform
    certain practices, both positive and negative, related to the
    research process, as well as the perception of the frequency with
    which other researchers perform them.
4.  **Open Data**: 17 items analyzing researchers' perceptions of the
    openness of data.
5.  **Reproducible Research**: 15 items exploring researchers'
    perceptions and practices regarding the openness of analysis in
    their research.
6.  **Open access to publication**: 16 items exploring researchers'
    perception and practices regarding open access to their research
    results.
7.  **ANID Open Access Policy**: 10 items exploring researchers'
    knowledge of ANID's Open Access Policy for publicly funded
    scientific information and research data.
8.  **Sociodemographic Characterization**: 5 item on the
    socio-demographic characteristic of the participants.

We used FormR for the implementation of the questionnaire. FormR is an
open source software that allows the design of complex questionnaires
with a high degree of customization [@arslan_chain_2025;
@arslan_formr_2020] . Since it is integrated with RStudio (R +
RMarkdown), it facilitates collaborative work regardless of the length
of the questionnaire. The platform allows the questionnaire to be
self-administered, either by personal computers or by smartphones.

To construct the sample, mass mailings were sent to researchers who had
received state research funding, to faculties and departments of various
social science disciplines, and to research centers and nuclei. In
addition, the survey was distributed through social media and at
academic events. In the end, 98 complete responses were received. The
description of the sample is presented in @tbl-resumen.

```{r, echo=FALSE}
#| label: "tbl-resumen"
#| tbl-cap: "Quantitative Sample Description"

dfSummary(cais_v2 %>% select(Sex= sexo, Age= edad, Degree= grado, "Career stage"= etapa, "Research strategy"= enfoq), headings = FALSE, graph.col = FALSE, varnumbers = F) %>%
  kable()

```

We conducted a descriptive uni- and bivariate analysis of the key
indicators of the questionnaire. We aimed to describe the respondents'
knowledge, practices and attitudes about open science and the constructs
described above. These variable were crossed by age group, research
focus, academic career stage, academic degree, and gender to detect
possible differences between groups.

## Results

### **Knowledge**

As shown in @fig-cca, the concept most recognized by the respondents is
open access to publications (79%), in line with what was described in
the qualitative study. Ideas such as open data (59%), the use of free
software for analysis (53%), and the concept of open science itself
(46%) have medium levels of knowledge among respondents. At the other
extreme, only 25% of respondents say they are familiar with the
pre-registration of hypotheses.

```{r cca, echo=FALSE}
#| label: fig-cca
#| fig-cap: "Familiarity with Open Science concepts"

# El siguiente gráfico visualiza una batería, es decir, varios tems con preguntas diferentes, pero iguales valores de respuesta. Este tipo de gráficos sigue la siguiente estructura tipo:
labels_cca <- c("Open Science", 
                "Publications \nopen access", 
                "Hypotheses \npre-registration", 
                "Open Data", 
                "Reproducible \nresearch", "Open \nrepositories", 
                "Open software", "Open data access")
  
cais_v2 %>%
  # TRASPONER PARA QUE EL LA BATERÍA PASE A SER UNA VARIABLE EN SÍ MISMA
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  # RECODE PARA REDUCIR COMPLEJIDAD DE LOS VALORES
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  # CONTABILIZA EL CRUCE DE LA BATERÍA CON SUS RESPECTIVOS VALORES
  count(name, value, .drop=F) %>%
  # CREA NUEVA VARIABLE DE CON LA FRECUENCIA RELATIVA DE CADA VALOR RESPECTO A LA VARIABLE
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>% 
  # GGPLOT DE BARRAS 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = value, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  # ESPECIFICACIONES PARA EL TEXTO DE LAS BARRAS
  geom_text(position = position_dodge(width  = .9),  size=3, hjust = -.1) +
  # ESPECIFICACIONES PARA ETIQUETAS DE TÍTULOS, EJES Y LEYENDA (RELLENO)
  labs(
       caption = legend, x = "", y = "", fill = "") + 
  # ESPECIFICACIONES PARA POSICIÓN DE LA LEYENDA (FILL)
  theme(legend.position = 'none') +
  # ESPECIFICACIÓN DE PALETA DE COLORES
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  # AJUSTE DE LA ESCALA DEL EJE Y (PASA A PORCENTAJE)
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  # AJUSTE DE ORDEN DE LEYENDA (FILL)
  guides(fill = guide_legend(reverse = TRUE)) +
  # AJUSTE DE VISUALIZACIÓN PARA ROTAR LAS COORDENADAS
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none",
        axis.text.x = element_text(size=10),
        axis.text.y= element_text(size=10),
        plot.caption= element_text(size=10))
```

In general, knowledge levels seem to be higher among young researchers
and with a predominantly quantitative focus, as shown in the
@fig-cca-grid. Respondents between 28 and 34 years of age, thus, show
higher levels of knowledge about free software, and the concepts of
reproducible research and open science (@fig-cca-grid-1). However,
researchers between 35 and 49 years of age show higher levels of
knowledge of hypotheses preregistration and open access to data.
Quantitative researchers, meanwhile, show higher levels of knowledge of
all concepts except open access to publications (@fig-cca-grid-2).

```{r 1-cca-edad, echo=FALSE}
#| label: fig-cca-grid
#| fig-cap: "Familiarity with Open Science concepts by age and reseaarch strategy" 
#| fig-subcap:
#|   - "Familiarity with open science concepts by age"
#|   - "Familiarity with open science concepts by research strategy" 
#| layout-ncol: 2
#| fig.height: 6

cais_v2 %>% 
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, edad, value, .drop=F) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)*100) %>%
  filter(value == "Alta") %>% 
  ggplot(aes(x = freq, y = reorder(name, freq), color = edad)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	      axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15)
	      ) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>% 
  count(name, enfoq, value, .drop=F) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)*100) %>%
  filter(value == "Alta") %>% 
  drop_na() %>% 
  ggplot(aes(x = freq, y = reorder(name, freq), color = enfoq)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = "",
		caption = legend
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	      axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

 
```

```{r cca-otros-cruces, echo=FALSE, include=FALSE}

# Etapa
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>%
  count(name, etapa, value, .drop=F) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>%
  ggplot(aes(x = reorder(name, freq), y = freq, fill = etapa,
             label = scales::percent(freq, accuracy = .1))) +
  geom_col(position = 'dodge2') +
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcetaje con alta familiaridad",
       caption = legend, x = "", y = "", fill = "Etapa de la carrera\nacadémica") +
  theme(legend.position = 'right',
        ) +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()

# Grado
cais_v2 %>%
  pivot_longer(cols = c(mod02_1, starts_with("mod02_2"))) %>%
  mutate(name = factor(name, labels = labels_cca),
         value = factor(car::recode(value, "1:3 = 1; 4:5 = 2; 6:7 = 3"),
                        labels = c("Baja", "Media", "Alta"))) %>%
  count(name, grado, value, .drop=F) %>%
  group_by(name, grado) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Alta") %>%
  ggplot(aes(x = reorder(name, freq), y = freq, fill = grado,
             label = scales::percent(freq, accuracy = .1))) +
  geom_col(position = 'dodge2') +
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = 'Familiaridad con conceptos de Ciencia Abierta', subtitle = "Porcentaje con alta familiaridad",
       caption = legend, x = "", y = "", fill = "Grádo académico") +
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()

# Muestran poca variación entre grupos
```

Similarly, ANID's Open Access to Scientific Information and Research
Data Policy shows a medium to low level of awareness. Specifically, only
half of the respondents have heard of ANID's policy. On the other hand,
only 26% are aware of ANID's data management plan for the open access
policy.

```{r anid-conocimiento, include=FALSE}
ANID <- lisa_v2_75 %>% # CONODIMIENTO DE ANID
  select(mod01_10, mod08_2, mod08_1, mod07_4, mod07_5) %>% 
  mutate_at(vars(starts_with("mod07")), 
            ~ if_else(. == 1, "Si", 
                      if_else(. == 2, "No", 
                              if_else(. == 3, "No se", NA_character_))))

frq(ANID$mod07_5) # CONOCE EL PLAN DE GESTION DE DATOS DE LA POLITICA DE ACCESO ABIERTO ANID?

ANID6 <- cais %>% 
  select(mod01_10, mod08_2, mod08_1, mod07_1) %>%
  mutate(
    mod07_1 = case_when(
      mod07_1 == 1 ~ "Sí",
      mod07_1 == 2 ~ "No",
      mod07_1 == 3 ~ "No sé",
      TRUE ~ NA_character_ ))

frq(ANID6$mod07_1)


```

### Practices

#### a. Own practices and Community's practices

In general, the frequency of practices related to open science is low,
as seen in @fig-prac. 32% of respondents always or almost always use
online repositories to upload information related to their research, and
16% report sharing code among researchers (@fig-prac-2). These types of
practices are more common among male researchers, those whose primary
research strategy is quantitative, and those who are in an early stage
in their academic careers.

```{r 3-prac, echo=FALSE}
#| label: fig-prac
#| fig-cap: "How often are the following practices performed?" 
#| fig-subcap:
#|   - "Community's practices"
#|   - "Own Practices" 
#| layout-ncol: 2
#| fig.height: 6

labels_comu <- c("Share codes between \nresearchers",
                 "Use online open repositories",
                 "Selective report of results",
                 "Do not report \nstudies or variables \n that did not reached \nstatistical signficance",
                 "Manipulating data to validate \nhypothesis")

labels_prop <- c("Share codes between \nresearchers",
                 "Use online open repositories",
                 "Selective report of results",
                 "Do not report \nstudies or variables \n that did not reached \nstatistical signficance")

pr_comu <- cais_v2 %>%  
  select(starts_with("mod03_1_")) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Community's Practices"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop <- cais_v2 %>% 
  select(starts_with("mod03_2_")) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Own Practices"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

pr_comu %>%
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  count(name, value, var, .drop=F) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Casi siempre o siempre") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size=4.5, hjust = -.1) +
  labs(subtitle = "Percentage responding \n'Almost always or always'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none",
        axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15),
        strip.text = element_text(size=15))

pr_prop %>%
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  count(name, value, var, .drop=F) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Casi siempre o siempre") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size=4.5, hjust = -.1) +
  labs(subtitle = "Percentage responding \n'Almost always or always'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none",
         axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15),
        strip.text = element_text(size=15))
```

Interestingly, researchers generally report better practices for
themselves than for the community. For example, only 14% believe that
the community always or almost always uses online repositories to upload
information related to their research, and 5% believe that researchers
share code with that frequency (@fig-prac-1).

This gap also exits in the case of malpractice. 9% of the respondents
say they almost always or always fail to report studies or variables
that do not reach statistical significance, while 45% believe this
practices are that common in the community. On the other hand, while 7%
say they selectively report results, 40% believe it is always or almost
always done in the community. Finally, while no one admits to having
manipulated data to validate a hypothesis, 4% say this always or almost
always happens in the community.

It is curious that when the analysis is broken down into different
groups, certain trends are repeated. Male, quantitative-oriented,
early-career researchers are at the same time those who declare the
highest frequency of own practices, both negative and positive, as well
as those perceive the highest number of negative practices in the
community. These differences can be seen in detail in the @fig-prac-grid

```{r prac-grid, echo= F}
#| label: fig-prac-grid
#| fig-cap: "How often are the following practices performed?" 
#| fig-subcap:
#|   - "By sex"
#|   - "By academic career stage" 
#|   - "By research strategy"
#| layout-ncol: 1
#| fig.height: 3

# Gráfico Sexo
pr_comu_sexo <- cais_v2 %>%  
  select(starts_with("mod03_1_"), sexo) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Community's practices"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop_sexo <- cais_v2 %>% 
  select(starts_with("mod03_2_"), sexo) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Own practices"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_sexo <- rbind(pr_comu_sexo, pr_prop_sexo) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Community's practices", "Own practices"))) %>% 
  count(name, value, var, sexo, .drop=F) %>%
  group_by(name, var, sexo) %>%
  mutate(freq = n/sum(n)*100)

practicas_sexo %>% 
  filter(value == "Casi siempre o siempre") %>% 
    ggplot(aes(x = freq, y = reorder(name, freq), color = sexo)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	      axis.text.x = element_text(size=6),
        axis.text.y= element_text(size=6),
	      legend.text= element_text(size=6),
	      plot.caption = element_text(size=6),
	      strip.text = element_text(size = 6)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  facet_wrap(~ var)

# Gráfico Etapa

pr_comu_etapa <- cais_v2 %>%  
  select(starts_with("mod03_1_"), etapa) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Community's practices"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop_etapa <- cais_v2 %>% 
  select(starts_with("mod03_2_"), etapa) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Own practices"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_etapa <- rbind(pr_comu_etapa, pr_prop_etapa) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Community's practices", "Own practices"))) %>% 
  count(name, value, var, etapa, .drop=F) %>%
  group_by(name, var, etapa) %>%
  mutate(freq = n/sum(n)*100)

practicas_etapa %>% 
  filter(value == "Casi siempre o siempre") %>% 
      ggplot(aes(x = freq, y = reorder(name, freq), color = etapa)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	       axis.text.x = element_text(size=6),
        axis.text.y= element_text(size=6),
	      legend.text= element_text(size=6),
	      plot.caption = element_text(size=6),
	      strip.text = element_text(size=6)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  facet_wrap(~ var)

# Gráfico enfoque

pr_comu_enfoq <- cais_v2 %>%
  filter(!is.na(enfoq)) %>%
  select(starts_with("mod03_1_"), enfoq) %>% pivot_longer(cols = starts_with("mod03_1_")) %>% 
  tibble(var = c(rep("Community's practices"))) %>% 
  mutate(name = factor(name, labels = labels_comu))

pr_prop_enfoq <- cais_v2 %>%
  filter(!is.na(enfoq)) %>%
  select(starts_with("mod03_2_"), enfoq) %>%  pivot_longer(cols = c(starts_with("mod03_2_"))) %>% 
  tibble(var = c(rep("Own practices"))) %>% 
  mutate(name = factor(name, labels = labels_prop))

practicas_enfoq <- rbind(pr_comu_enfoq, pr_prop_enfoq) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nunca o casi nunca", "A veces", "Casi siempre o siempre"))) %>%
  mutate(var = factor(var, levels = c("Community's practices", "Own practices"))) %>% 
  count(name, value, var, enfoq, .drop=F) %>%
  group_by(name, var, enfoq) %>%
  mutate(freq = n/sum(n)*100)

practicas_enfoq %>% 
  filter(value == "Casi siempre o siempre") %>% 
        ggplot(aes(x = freq, y = reorder(name, freq), color = enfoq)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = "",
		caption = legend
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	       axis.text.x = element_text(size=6),
        axis.text.y= element_text(size=6),
	      legend.text= element_text(size=6),
	      plot.caption = element_text(size=6),
	      strip.text = element_text(size=6)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  facet_wrap(~ var)

```

#### b. Open Science Barriers

There is a high perception of barriers to the development of Open
Science in all its dimensions. Lack of policy is perceived as the main
barrier in all dimensions, as can be seen in the @fig-barreras. Lacks of
knowledge also appears as a major barrier especially for transparent
design, open data and reproducible research. Finally, lack of incentives
is recognized as another aspect that hinders data openness.

```{r 4-bca-comp, echo=FALSE}
#| label: fig-barreras
#| fig-cap: "¿To what extent do you consider that the following factors limit Open Science?"

var_label_barreras <- c("Lack of knowledge",
                        "Lack of time",
                        "Lack of incentives",
                        "Possibility of plagiarism",
                        "Lack of policy")


disen <- cais_v2 %>%  
  select(starts_with("mod03_3_")) %>% pivot_longer(cols = starts_with("mod03_3_")) %>% 
  tibble(var = c(rep("Transparent design"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

datos <- cais_v2 %>% 
  select(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5) %>%  pivot_longer(cols = c(mod04_3_1, mod04_3_2, mod04_3_3, mod04_3_4, mod04_3_5)) %>% 
  tibble(var = c(rep("Open data"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

repro <- cais_v2 %>% 
  select(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5) %>% pivot_longer(cols = c(mod05_6_1, mod05_6_2, mod05_6_3, mod05_6_4, mod05_6_5)) %>% 
  tibble(var = c(rep("Reproducible research"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

publi <- cais_v2 %>% 
  select(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5) %>% pivot_longer(cols = c(mod06_6_1, mod06_6_2, mod06_6_3, mod06_6_4, mod06_6_5)) %>% 
  tibble(var = c(rep("Open publications"))) %>% 
  mutate(name = factor(name, labels = var_label_barreras))

barreras <- rbind(disen, datos, repro, publi) %>% 
  mutate(value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Nada o un poco", "Moderadamente", "Bastante o mucho"))) %>%
  mutate(var = factor(var, levels = c("Transparent design", "Open data", "Reproducible research", "Open publications"))) %>% 
  count(name, value, var, .drop=F) %>%
  group_by(name, var) %>%
  mutate(freq = n/sum(n))

barreras %>% 
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = '#f1605d',
           label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size=3, hjust = -.1) +
  labs(subtitle = "Porcentage responding 'Quite a lot or very much'", caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'none') +
  #scale_colour_viridis_d(option = "magma", begin = 0, end = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  facet_wrap(~ var) +
  theme_minimal() +
  theme(legend.position = "none",
         axis.text.x = element_text(size=8),
        axis.text.y= element_text(size=10),
	      legend.text= element_text(size=8),
	      plot.caption = element_text(size=10),
	      strip.text = element_text(size=10))
```

Regarding this last point, the incentives that researchers might have to
open their data were analyzed. As can be seen in the @fig-motivaciones,
networking, the dissemination of publicly funded data to the community,
and the increase of one's own visibility are highly valued as incentives
for open data.

```{r motivaciones apertura, echo=F}
#| label: fig-motivaciones
#| fig-cap: "Open data motivations"

# analisis otras variables.
# Motivaciones apertura de datos ----

labels_motiv <- c("Networking",
                  "Results dissemination",
                  "Increase visibility")

cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_motiv),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, .drop=F) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
filter(value=="Alta motivación") %>%
ggplot(aes(x = reorder(name, freq), y = freq, fill = value, label = scales::percent(freq, accuracy = 0.1))) + 
  geom_col(position = 'dodge2') +
  geom_text(position = position_dodge(width = 0.9), size=3, hjust = -0.1) +
  labs(caption = legend, x = "", y = "", fill = "") + 
  scale_fill_viridis_d(option = "magma", begin = 0.1, end = 0.7, direction = -1) + 
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal()+
  theme(legend.position = "none",
         axis.text.x = element_text(size=10),
        axis.text.y= element_text(size=10),
	      legend.text= element_text(size=9),
	      plot.caption = element_text(size=10),
	      strip.text = element_text(size=10))
```

It is interesting to note that, as can be seen in the
@fig-motivaciones-grid, while the dissemination of results is valued
transversally, there are groups where the valuation of extrinsic
motivations has a greater preponderance. In particular, networking and
increasing one's own visibility are incentives more highly valued by
women (@fig-motivaciones-grid-1) and researchers between 35 and 49 years
of age (@fig-motivaciones-grid-2)

```{r motivaciones-grid}
#| label: fig-motivaciones-grid
#| fig-cap: "Open data motivations"
#| fig-subcap:
#|   - "By sex"
#|   - "By age" 
#| layout-ncol: 2
#| fig.height: 6


cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_motiv),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, sexo, .drop=F) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)*100) %>% 
  filter(value=="Alta motivación") %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = sexo)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	       axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15),
	      strip.text = element_text(size=15)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod04_2_")))  %>%
  mutate(name = factor(name, labels = labels_motiv),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3"),
                        labels = c("Poca motivación", "Moderadamente", "Alta motivación"),
                        levels = 1:3)) %>%
  filter(!is.na(value)) %>%
  count(name, value, edad, .drop=F) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)*100) %>% 
  filter(value=="Alta motivación") %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = edad)) +
  geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = "",
		caption = legend
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	       axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15),
	      strip.text = element_text(size=15)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)
  
```

### Attitudes

#### a. Attitudes on Open Science Measures

In general, the possibility of adopting Open Science measures in the
social sciences is assessed positively, as can be see in @fig-val. Open
access (92%), replication of results (67%), reporting of
non-statistically significant results (76%), and online availability of
data and analysis materials (72%) all show a high level of acceptance
among respondents. The only exception is the pre-registration of
hypothesis, which received a positive evaluation of only 42%. This is
explained by a higher level of unfamiliarity (17% say they are not aware
of the measure), in addition to the reluctance already observed in the
qualitative study.

```{r 2-vca, echo=FALSE}
#| label: fig-val
#| fig-cap: "How necessary do you think the following Open Science measure are for social science research?"

labels_valor <- c("Pre-register hypotheses",
                  "Make data, materials \nand analysis \navailable online",
                  "Report results even \nnot statistically significant",
                  "Replicate and review \npublished findings",
                  "Make publications \nopen access")
  
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Not at all \nor quite a little", "Moderately", "A lot or \nquite a lot", "Don't \nknow it"),
                        levels = 1:4)) %>% 
  count(name, value, .drop=F) %>%
  group_by(name) %>%
  mutate(freq = n/sum(n)) %>%
  ggplot(aes(x = name, y = freq, fill = factor(value, levels = c("Don't \nknow it", "Not at all \nor quite a little", "Moderately", "A lot or \nquite a lot")), 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'Stack') + 
  geom_text(position = position_stack(vjust = .5), size=2.5, color = 'white') +
  labs(caption = legend, x = "", y = "", fill = "") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "bottom",
        axis.text.x = element_text(size=10),
        axis.text.y= element_text(size=10),
	      legend.text= element_text(size=9),
	      plot.caption = element_text(size=10),
	      strip.text = element_text(size=10))
```

With the exception of open access to publications, which is valued
transversally by all groups, these measures are more strongly supported
by females researchers and by researchers with a quantitative approach,
as can be seen in the @fig-vca-grid

```{r 2-vca-sexo, echo=FALSE}
#| label: fig-vca-grid
#| fig-cap: "How necessary do you think the following Open Science measure are for social science research? -- porcentage responding a lot or quite a lot "
#| fig-subcap:
#|   - "By research strategy"
#|   - "By sex" 
#| layout-ncol: 2
#| fig.height: 6

cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Not at all or quite a little", "Moderately", "A lot or quite a lot", "Don't know it"),
                        levels = 1:4)) %>% 
  count(name, value, enfoq, .drop=F) %>%
  group_by(name, enfoq) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "A lot or quite a lot" & !is.na(enfoq)) %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = enfoq)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = "",
		caption = ""
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	       axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15),
	      strip.text = element_text(size=15)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  guides(color=guide_legend(nrow=2,byrow=TRUE))

cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Not at all or quite a little", "Moderately", "A lot or quite a lot", "Don't know it"),
                        levels = 1:4)) %>% 
  count(name, value, sexo, .drop=F) %>%
  group_by(name, sexo) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "A lot or quite a lot") %>%
  ggplot(aes(x = freq, y = reorder(name, freq), color = sexo)) +
  	geom_line(size = 0.8, aes(group = name), color = "gray30") +  # Añadir líneas entre puntos de la misma práctica
	geom_point(size = 3) +  # Crear puntos para cada práctica
	# geom_text_repel(  # Evitar solapamiento de etiquetas
	# 	aes(label = paste0(round(freq, 1), "%")),
	# 	size = 3,
	# 	nudge_x = 5,  # Ajustar posición horizontal
	# 	direction = "y"
	# ) +
	labs(
		x = "",
		y = "",
		color = "",
		caption= legend
	) +
	theme_minimal() +
	theme(legend.position = "bottom",
	       axis.text.x = element_text(size=15),
        axis.text.y= element_text(size=15),
	      legend.text= element_text(size=12),
	      plot.caption = element_text(size=15),
	      strip.text = element_text(size=15)) +
  scale_color_viridis_d(option = "magma", begin = .1, end = .7, direction = -1)

```

```{r 2-vca-edad, echo=FALSE, include=F}
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, edad, .drop=F) %>%
  group_by(name, edad) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = edad, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Grupo etario") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1.1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

```{r otros-vca, echo=FALSE, include=F}
#Etapa
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, etapa, .drop=F) %>%
  group_by(name, etapa) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = etapa, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Etapa de la carrera\nacadémica") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1.1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()

#Grado
cais_v2 %>%
  pivot_longer(cols = c(starts_with("mod02_4_"))) %>%
  mutate(name = factor(name, labels = labels_valor),
         value = factor(car::recode(value, "1:2 = 1; 3 = 2; 4:5 = 3; 6 = 4"),
                        labels = c("Nada o poco", "Moderadamente", "Bastante o mucho", "No la conoce"),
                        levels = 1:4)) %>% 
  count(name, value, grado, .drop=F) %>%
  group_by(name, grado) %>%
  mutate(freq = n/sum(n)) %>%
  filter(value == "Bastante o mucho") %>% 
  ggplot(aes(x = reorder(name, freq), y = freq, fill = grado, 
             label = scales::percent(freq, accuracy = .1))) + 
  geom_col(position = 'dodge2') + 
  geom_text(position = position_dodge(width  = .9),  size = 2.5, hjust = -.1) +
  labs(title = '¿Qué tan necesarias cree que son las siguientes medidas\nimpulsadas por la CA para la investigación en Ciencias Sociales?:',
       subtitle = "Porcentaje que responde 'Bastante o mucho'", caption = legend, x = "", y = "", fill = "Grado académico") + 
  theme(legend.position = 'right') +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = -1) +
  scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
  guides(fill = guide_legend(reverse = TRUE)) +
  coord_flip()
```

#### b. Attitudes about the Replication Crisis

As shown in the @fig-dona, 39% of respondents believe there is a major
replication crisis, while 40% do not know if there is one. Concern is
greater among quantitative researchers, as seen in @fig-dona-grid, with
70% believing that the crisis is important. While there is no denial of
the crisis among qualitative researchers, 60% do not know if there is a
crisis or not.

```{r crisis-reproducibilidad}
#| label: fig-dona
#| fig-cap: With which of the following statement regarding the replication crisis do you agree?

cais_v2 %>% 
  mutate(mod05_3= factor(mod05_3, 
                         labels= c("There is no replication crisis",
                                   "There is a slight replication crisis",
                                   "There is a mejor reproducibility crisis",
                                   "Don't know"),
                         levels= 1:4)) %>%
  group_by(mod05_3) %>% 
  summarise(n= n()) %>%
   mutate(freq = n / sum(n),
         porcentaje = paste0(round(freq * 100, 1), "%")) %>%
ggplot(aes(x = 2, y = freq, fill = mod05_3)) + 
    geom_bar(stat = "identity", width = 1, color = "white") +
    coord_polar(theta = "y") +
    xlim(0.5, 2.5) + # PARA EL TAMANO # REVISAR COLORES
    labs(fill = "",
         caption= "Source: CAIS(2024), N=49") +
    theme_minimal() +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1) +
    theme(legend.position = "right",
      axis.text = element_blank(),
      axis.title = element_blank(),
      panel.grid = element_blank(),
      plot.title = element_text(face = "bold", hjust = 0.5),
      plot.subtitle = element_text(hjust = 0.5),
      legend.text = element_text(size=10),
      plot.caption = element_text(size=10)) + 
      geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), # posicion etiqueta
            color = "white", size=3) # texto

```

```{r crisis-enfoque}
#| label: fig-dona-grid
#| fig-cap: Perception of the reproducibility crisis by research strategy.


# Entre investigadores cuantiativos el 82% cree que la crisis es importe. Entre investigadores cuali, el 59% no sabe. 

# GRAFICAR. TRES GRAFICOS DE DONA, UNA POR ENFOQUE EN UN GRILLA?

cais_v2 %>%
  mutate(mod05_3 = factor(mod05_3, 
                          labels = c("There is no \nreplication crisis",
                                   "There is a slight \nreplication crisis",
                                   "There is a mejor \nreplication crisis",
                                   "Don't know"),
                          levels = 1:4)) %>%
  filter(!is.na(mod05_3) & !is.na(enfoq)) %>%  #Elimina valores NA
  group_by(enfoq, mod05_3) %>% 
  summarise(n = n(), .groups = "drop")%>% 
  complete(enfoq, mod05_3, fill = list(n = 0)) %>%  # rellenar vacios
  group_by(enfoq) %>% 
  mutate(freq = n / sum(n),
         porcentaje = paste0(round(freq * 100, 1), "%")) %>% # porcentajes
  ggplot(aes(x = 2, y = freq, fill = mod05_3)) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar(theta = "y") +
  scale_fill_brewer(palette = "Pastel1") + # colores
  labs(fill = "", caption= "Source: CAIS (2024), N=49") +
  theme_minimal() +
  theme(legend.position = "bottom",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.text= element_text(size=9),
    plot.caption= element_text(size=10),
    strip.text= element_text(size=10)
  ) +
  facet_grid(~enfoq) + 
  xlim(1, 2.5) +
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), # Centra las etiquetas
            color = "white", size=3) + # Ajusta texto
scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1)

```

On the other hand, 59% believe that 30% or less of social science
research is reproducible, while 83% believe that less than half of
social science research is reproducible, as shown in @tbl-tablaacum

```{r, percecpcion-repro, include=T}
#| label: tbl-tablaacum
#| tbl-cap: "Perception of the percentage of reproducible research in Social Sciences"
cais_v2 %>% 
  group_by(mod05_4) %>%
  summarise(n = n()) %>%
   mutate(acum = round(cumsum(n / sum(n)) * 100, 2)) %>%
  kable(col.names = c("Reproducible \nResearches", "Frequency", "Acum (%)"))

```

This is consistent with the 40% of respondents having attempted to
reproduce the results of other researchers (@fig-reprod-1). Of this
percentage, only 20% of the attempts were complete reproductions, while
69% were only partial (@fig-reprod-2)

```{r, include=T}
#| label: fig-reprod
#| fig-cap: "Practices associated with reproducibility"
#| fig-subcap:
#| - "Have you tried to reproduce someone else's results?"
#| - "If you have tried, which of these stages did you fall into?"
#| layout-ncol: 2
#| fig.height: 6

cais_v2 %>% 
  mutate(mod05_5_3 = factor(mod05_5_3, 
                            labels = c("Yes", "No", "Don't know"),
                            levels = 1:3)) %>%
  drop_na(mod05_5_3) %>%  # Filtra los NA
  group_by(mod05_5_3) %>% 
  summarise(n = n()) %>%
  mutate(freq = n / sum(n),
         porcentaje = paste0(round(freq * 100, 1), "%")) %>%
  ggplot(aes(x = 2, y = freq, fill = mod05_5_3)) + 
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar(theta = "y") +
  xlim(0.5, 2.5) +  # Ajusta el tamaño
  labs(fill = "") +
  theme_minimal() +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1) +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        panel.grid = element_blank(),
        plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        legend.position = "right",
        legend.text = element_text(size=15)) + 
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5),  # Centra las etiquetas
            color = "white", size=4.5) 
  


#----------------------------

cais_v2 %>%
  mutate(mod05_5_4 = factor(mod05_5_4,
                            labels = c("Not successful", "Partially successful", "Successful"),
                            levels = 1:3)) %>%
  drop_na(mod05_5_4) %>%  # Filtra los NA
  group_by(mod05_5_4) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n),
         porcentaje = paste0(round(freq * 100, 1), "%")) %>%
  ggplot(aes(x = 2, y = freq, fill = mod05_5_4)) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar(theta = "y") +
  xlim(0.5, 2.5) +  # Ajusta el tamaño
  labs(fill = "", caption= "Source: CAIS (2024), N=49") +
  theme_minimal() +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1) +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        panel.grid = element_blank(),
        plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        legend.position = "right",
        legend.text = element_text(size=15),
        plot.caption = element_text(size=15)) +
  geom_text(aes(label = porcentaje),
            position = position_stack(vjust = 0.5),  # Centra las etiquetas
            color = "white", size=4.5)
```

#### c. Attidues about ANID's Open Science policies

In the first instance, ANID's Open Science Policy is well received by
the respondents. For example, 90% agree or strongly agree that ANID
should continue to develop its Open Science Policy, as show in
@fig-vanid-grid-2. Similarly, 84% consider the implementation of Open
Access policies to be quite or very necessary, as shown in
@fig-vanid-grid-1

```{r, include=T}
#| label: fig-vanid-grid
#| fig-cap: "Assessment of ANID's open science policies"
#| fig-subcap: 
#| - "How necessary is the implementation of mandatory open access policies for publicly funded research?"
#| - "How much do you agree with ANID continuing to develop and implement open access policies for scientific production?"
#| layout-ncol: 2
#| fig.height: 6

cais_v2 %>%
  mutate(mod07_2 = factor(mod07_2,
                          labels = c("Not necessary at all",
                                     "Slightly necessary",
                                     "Moderately necessary",
                                     "Quite necessary",
                                     "Very necessary"),
                          levels = 1:5)) %>%
  drop_na(mod07_2) %>%
  group_by(mod07_2) %>%
  summarise(n = n()) %>%  
  mutate(freq = n / sum(n), 
         porcentaje = paste0(round(freq * 100, 1), "%")) %>%
  ggplot(aes(x = 2, y = freq, fill = mod07_2)) +
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar(theta = "y") +  
  labs(fill = "") +
  theme_minimal() +
  theme(legend.position= "right",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.text = element_text(size=15)
  ) + 
  xlim(1, 2.5) +
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), 
            color = "white", size = 4.5) +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1)

#---------------------------------------------

cais_v2 %>%
  mutate(mod07_7 = factor(mod07_7,
                          labels = c("Strongly Disagree",
                                     "Disagree",
                                     "Neither Agree nor Disagree",
                                     "Agree",
                                     "Strongly Agree"),
                          levels = 1:5)) %>%
  drop_na(mod07_7) %>%
  group_by(mod07_7) %>%
  summarise(n = n()) %>%  
  mutate(freq = n / sum(n), 
         porcentaje = paste0(round(freq * 100, 1), "%")) %>% ggplot(aes(x = 2, y = freq, fill = mod07_7)) +
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar(theta = "y") +  
  labs(fill = "", caption= "Source CAIS (2024), N=49") +
  theme_minimal() +
  theme(legend.position = "right",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.text= element_text(size=12),
     plot.caption = element_text(size=15)
  ) + 
  xlim(1, 2.5) +
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), 
            color = "white", size = 4.5) +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1)
```

However, there are other practices that are less well received. Thus,
both mandatory pre-registration, as shown in @fig-vanid-grid-b-1, and
reproducibility (@fig-vanid-grid-b-2), are supported only by half of the
respondents.

```{r, include=T}
#| label: fig-vanid-grid-b
#| fig-cap: "Assessment inclusion of practices in ANID's Open Access Policy"
#| fig-subcap: 
#| - "How neccesary is it for ANID to incorporate pre-registration of research design within its Open Access Policy?"
#| - "How neccesary is it for ANID to incorporate reproducibility of research within its Open Access Policy"
#| layout-ncol: 2
#| fig.height: 6

cais_v2 %>%
  mutate(mod07_8 = factor(mod07_8,
                          labels = c("Not necessary at all",
                                     "Slightly necessary",
                                     "Moderately necessary",
                                     "Quite necessary",
                                     "Very necessary"),
                          levels = 1:5)) %>%
  drop_na(mod07_8) %>%
  group_by(mod07_8) %>%
  summarise(n = n()) %>%  
  mutate(freq = n / sum(n), 
         porcentaje = paste0(round(freq * 100, 1), "%")) %>% ggplot(aes(x = 2, y = freq, fill = mod07_8)) +
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar(theta = "y") +  
  labs(fill = "") +
  theme_minimal() +
  theme(legend.position = "right",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.text= element_text(size=12)
  ) + 
  xlim(1, 2.5) +
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), 
            color = "white", size=4.5) +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1)

#----------------------

cais_v2 %>%
  mutate(mod07_9 = factor(mod07_9,
                          labels = c("Not necessary at all",
                                     "Slightly necessary",
                                     "Moderately necessary",
                                     "Quite necessary",
                                     "Very necessary"),
                          levels = 1:5)) %>%
  drop_na(mod07_9) %>%
  group_by(mod07_9) %>%
  summarise(n = n()) %>%  
  mutate(freq = n / sum(n), 
         porcentaje = paste0(round(freq * 100, 1), "%")) %>% ggplot(aes(x = 2, y = freq, fill = mod07_9)) +
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar(theta = "y") +  
  labs(fill = "", caption= "Source: CAIS (2024), N=49") +
  theme_minimal() +
  theme(legend.position = "right",
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.text= element_text(size=12),
    plot.caption = element_text(size=15)
  ) + 
  xlim(1, 2.5) +
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), 
            color = "white", size=4.5) +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1)

```

Finally, the dissemination of ANID's Open Access policy is negatively
evaluated by the majority of respondents. Only 24% consider it to be
good or very good, as seen in @fig-vanid-2

```{r}
#| label: fig-vanid-2
#| fig-cap: "How do you evaluate the dissemination of the Open Access to Scientific Information and Research Data Policy"

cais_v2 %>%
  mutate(mod07_10 = factor(mod07_10,
                          labels = c("Bad",
                                     "Fair",
                                     "Neutral",
                                     "Good",
                                     "Very Good"),
                          levels = 1:5)) %>%
  drop_na(mod07_10) %>%
  group_by(mod07_10) %>%
  summarise(n = n()) %>%  
  mutate(freq = n / sum(n), 
         porcentaje = paste0(round(freq * 100, 1), "%")) %>% ggplot(aes(x = 2, y = freq, fill = mod07_10)) +
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar(theta = "y") +  
  labs(fill = "", caption= "Source: CAIS (2024), N=49") +
  theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.text = element_text(size=10),
    plot.caption = element_text(size=10),
    legend.position = "right"
  ) + 
  xlim(1, 2.5) +
  geom_text(aes(label = porcentaje), 
            position = position_stack(vjust = 0.5), 
            color = "white", size=3) +
  scale_fill_viridis_d(option = "magma", begin = .1, end = .7, direction = 1)
```
